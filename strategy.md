# Webアプリでの高効率なデータ同期

Excelライクなテーブルデータのエディタ。
複数人が同時操作してもある程度リアルタイムに同期する。
厳密なトランザクションはDBレベルで管理するが、今回はそれを行わない。

技術スタック：
- バックエンド: FastAPI (Python)
- フロントエンド: Next.js (React/TypeScript)
- 状態管理: Zustand
- リアルタイム同期: WebSocket

## 設計思想

- リアルタイム同期:
  - 双方向通信が可能で、低遅延なWebSocketを選択。
- 状態管理:
  - フロントエンドでZustandを用いてエディタの状態（カラム内容など）を管理。
- データ更新の効率化:
  - ユーザーの入力操作（例: onChange イベント）ごとにWebSocketでデータを送信すると、サーバーとネットワークに過大な負荷がかかる。
  - throttle（または debounce）を用いて、一定時間内の連続的な操作をまとめて送信するようにし、通信頻度を抑制。
- データ形式:
  - 送信するデータは、エディタの全内容を毎回送るのではなく、変更差分（diff）
- サーバー役割:
  - サーバー（FastAPI）は、各テーブル（編集対象）ごとにWebSocket接続を管理し、受け取った変更内容を該当テーブルを編集している他の全ユーザーにブロードキャストする役割を担う。
  - また、ドキュメントの最新状態を保持する（本来はDBだが、今回はインメモリ）。
